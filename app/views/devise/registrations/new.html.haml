- content_for :head do
  = tag :meta, :name => "stripe-key", :content => STRIPE_PUBLIC_KEY
= render "layouts/home_navigation"
.container
  %h2.title Sign up
  #stripe_error.alert.alert-error{:style => "display:none"}
  = simple_form_for(resource, :as => resource_name, :url => registration_path(resource_name), :html => {:class => 'card_form form-vertical' }) do |f|
    %h3
    = hidden_field_tag 'plan', params[:plan]
    = f.error_notification
    = display_base_errors resource
    - @company = resource.build_owned_company
    = f.simple_fields_for :owned_company do |ff|
      = ff.input :name, label: "Company Name"
      - @company.build_address if @company.address.nil?
      = ff.fields_for :address do |fff|
        = fff.input :address1
        = fff.input :address2
        = fff.input :city
        = fff.input :state
        = fff.input :zip
    = f.input :name, label: "Full Name", :autofocus => true
    = f.input :email, :required => true
    = f.input :password, :required => true
    = f.input :password_confirmation, :required => true
    .well
      - if @user.stripe_token
        %p{style: "margin: 0;"} Credit card acceptance is pending.
      - else
        %h4
          = params[:plan].titleize if params[:plan]
          Billing
        .field
          = label_tag :card_number, "Credit Card Number"
          = text_field_tag :card_number, nil, name: nil
        .field
          = label_tag :card_code, "Card Security Code (CVV)"
          = text_field_tag :card_code, nil, name: nil
          = image_tag "cards/cvv.png", style: "position: relative; top: -5px;"
        .field
          = label_tag :card_month, "Card Expiration"
          = select_month nil, {add_month_numbers: true}, {name: nil, id: "card_month"}
          = select_year nil, {start_year: Date.today.year, end_year: Date.today.year+10}, {name: nil, id: "card_year"}
        .field
          = f.input :coupon, :label => 'Promotional Coupon (if any)'
      = f.hidden_field :stripe_token
    = f.button :submit, 'Sign up', :class => 'btn-primary'
